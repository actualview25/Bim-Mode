<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>BIM Virtual Tour</title>
  <link rel="stylesheet" href="vendor/reset.min.css">
  <link rel="stylesheet" href="css/free-mode.css">
  <style>
    /* أنماط إضافية للواجهة */
    #viewer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
    #overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
    #overlay svg { width: 100%; height: 100%; pointer-events: none; }
    .electrical-path { stroke: #00ff00; stroke-width: 3; stroke-dasharray: 5,5; fill: none; }
    
    /* قائمة المشاهد */
    #sceneList { position: absolute; top: 60px; left: 10px; z-index: 1000; background: rgba(0,0,0,0.8); border-radius: 5px; max-height: 80vh; overflow-y: auto; }
    #sceneList ul { list-style: none; padding: 0; margin: 0; }
    #sceneList li { padding: 10px 20px; color: white; cursor: pointer; border-bottom: 1px solid #333; }
    #sceneList li:hover { background: #444; }
    #sceneList li.current { background: #0066cc; }
    
    /* لوحة البيانات */
    #data-panel { position: absolute; bottom: 20px; right: 20px; background: rgba(0,0,0,0.9); color: white; padding: 15px; border-radius: 8px; max-width: 300px; display: none; z-index: 1000; }
    #data-panel.visible { display: block; }
    .close-panel { float: right; cursor: pointer; font-size: 20px; }
    
    /* أزرار التحكم */
    .bim-controls { position: absolute; bottom: 20px; left: 20px; z-index: 1000; }
    .bim-controls button { padding: 10px 15px; margin: 5px; background: #0066cc; color: white; border: none; border-radius: 4px; cursor: pointer; }
    .bim-controls button:hover { background: #0055aa; }
  </style>
</head>
<body>

<div id="viewer"></div>

<!-- طبقات SVG للعناصر المعمارية -->
<div id="overlay">
  <svg id="walls-layer"></svg>
  <svg id="electrical-layer"></svg>
  <svg id="plumbing-layer"></svg>
  <svg id="hvac-layer"></svg>
</div>

<!-- قائمة المشاهد -->
<div id="sceneList">
  <ul class="scenes" id="scenesList"></ul>
</div>

<!-- لوحة عرض البيانات -->
<div id="data-panel">
  <span class="close-panel" onclick="this.parentElement.classList.remove('visible')">&times;</span>
  <h3 id="panel-title">Architectural Data</h3>
  <div id="panel-content"></div>
</div>

<!-- أزرار التحكم في طبقات BIM -->
<div class="bim-controls">
  <button id="toggleWalls" class="layer-btn active" data-layer="walls">الجدران</button>
  <button id="toggleElectrical" class="layer-btn" data-layer="electrical">الكهرباء</button>
  <button id="togglePlumbing" class="layer-btn" data-layer="plumbing">السباكة</button>
  <button id="toggleHVAC" class="layer-btn" data-layer="hvac">التكييف</button>
</div>

<!-- أزرار التنقل (من المشروع الأصلي) -->
<div id="nav-controls" style="display: none;">
  <a href="javascript:void(0)" id="autorotateToggle">
    <img class="icon off" src="img/play.png">
    <img class="icon on" src="img/pause.png">
  </a>
  <a href="javascript:void(0)" id="fullscreenToggle">
    <img class="icon off" src="img/fullscreen.png">
    <img class="icon on" src="img/windowed.png">
  </a>
</div>

<script src="vendor/marzipano.js"></script>
<script src="vendor/screenfull.min.js"></script>
<script src="data.js"></script>
<script src="js/bim-data.js"></script>
<script src="js/layers.js"></script>
<script src="js/viewer.js"></script>
<script src="js/ui.js"></script>

<script>
  // تهيئة التطبيق بعد تحميل كل الملفات
  window.addEventListener('load', function() {
    if (typeof initBIMViewer === 'function') {
      initBIMViewer();
    }
  });
</script>
<!-- أزرار التحكم من المشروع الأصلي -->
<div id="titleBar" style="position: absolute; top: 0; left: 0; right: 0; height: 40px; z-index: 100; text-align: center;">
  <h1 class="sceneName" style="color: white; margin: 0; line-height: 40px; background: rgba(0,0,0,0.5);"></h1>
</div>

<div style="position: absolute; top: 10px; right: 10px; z-index: 100; display: flex; gap: 10px;">
  <a href="javascript:void(0)" id="autorotateToggle" style="display: block; width: 40px; height: 40px; background: rgba(0,0,0,0.6); border-radius: 50%; text-align: center; line-height: 40px;">
    <img class="icon off" src="img/play.png" style="width: 24px; height: 24px; margin-top: 8px;">
    <img class="icon on" src="img/pause.png" style="width: 24px; height: 24px; margin-top: 8px; display: none;">
  </a>
  
  <a href="javascript:void(0)" id="fullscreenToggle" style="display: block; width: 40px; height: 40px; background: rgba(0,0,0,0.6); border-radius: 50%; text-align: center; line-height: 40px;">
    <img class="icon off" src="img/fullscreen.png" style="width: 24px; height: 24px; margin-top: 8px;">
    <img class="icon on" src="img/windowed.png" style="width: 24px; height: 24px; margin-top: 8px; display: none;">
  </a>
</div>

<div style="position: absolute; top: 10px; left: 10px; z-index: 100;">
  <a href="javascript:void(0)" id="sceneListToggle" style="display: block; width: 40px; height: 40px; background: rgba(0,0,0,0.6); border-radius: 50%; text-align: center; line-height: 40px;">
    <img class="icon off" src="img/expand.png" style="width: 24px; height: 24px; margin-top: 8px;">
    <img class="icon on" src="img/collapse.png" style="width: 24px; height: 24px; margin-top: 8px; display: none;">
  </a>
</div>
</body>
</html>
